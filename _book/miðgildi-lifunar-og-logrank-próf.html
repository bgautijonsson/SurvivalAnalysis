<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Miðgildi lifunar og logrank próf | Lecture Notes on Survival Analysis</title>
  <meta name="description" content="This is a collection of lectures notes from the course at University of Iceland" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Miðgildi lifunar og logrank próf | Lecture Notes on Survival Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a collection of lectures notes from the course at University of Iceland" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Miðgildi lifunar og logrank próf | Lecture Notes on Survival Analysis" />
  
  <meta name="twitter:description" content="This is a collection of lectures notes from the course at University of Iceland" />
  

<meta name="author" content="Thor Aspelund" />
<meta name="author" content="Brynjólfur Gauti Jónsson" />


<meta name="date" content="2020-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="kaplan-meier-gröf-eftir-hópum.html"/>
<link rel="next" href="víti-að-varast-og-breyting-á-tímaskala.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">University of Iceland</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-book"><i class="fa fa-check"></i><b>1.1</b> The Book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#theory"><i class="fa fa-check"></i><b>1.2</b> Theory</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>1.3</b> Software</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#setup-in-rstudio"><i class="fa fa-check"></i><b>1.4</b> Setup in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-survival-analysis.html"><a href="introduction-to-survival-analysis.html"><i class="fa fa-check"></i><b>2</b> Introduction to Survival Analysis</a></li>
<li class="chapter" data-level="3" data-path="inngangur.html"><a href="inngangur.html"><i class="fa fa-check"></i><b>3</b> Inngangur</a></li>
<li class="chapter" data-level="4" data-path="skerðing-censoring.html"><a href="skerðing-censoring.html"><i class="fa fa-check"></i><b>4</b> Skerðing (censoring)</a></li>
<li class="chapter" data-level="5" data-path="kaplan-meier-metillinn.html"><a href="kaplan-meier-metillinn.html"><i class="fa fa-check"></i><b>5</b> Kaplan Meier metillinn</a></li>
<li class="chapter" data-level="6" data-path="kaplan-meier-gröf.html"><a href="kaplan-meier-gröf.html"><i class="fa fa-check"></i><b>6</b> Kaplan Meier gröf</a></li>
<li class="chapter" data-level="7" data-path="kaplan-meier-gröf-eftir-hópum.html"><a href="kaplan-meier-gröf-eftir-hópum.html"><i class="fa fa-check"></i><b>7</b> Kaplan Meier gröf eftir hópum</a></li>
<li class="chapter" data-level="8" data-path="miðgildi-lifunar-og-logrank-próf.html"><a href="miðgildi-lifunar-og-logrank-próf.html"><i class="fa fa-check"></i><b>8</b> Miðgildi lifunar og logrank próf</a></li>
<li class="chapter" data-level="9" data-path="víti-að-varast-og-breyting-á-tímaskala.html"><a href="víti-að-varast-og-breyting-á-tímaskala.html"><i class="fa fa-check"></i><b>9</b> Víti að varast og breyting á tímaskala</a></li>
<li class="chapter" data-level="10" data-path="some-non-parametric-procedures.html"><a href="some-non-parametric-procedures.html"><i class="fa fa-check"></i><b>10</b> Some Non-Parametric Procedures</a></li>
<li class="chapter" data-level="11" data-path="the-cox-regression-model.html"><a href="the-cox-regression-model.html"><i class="fa fa-check"></i><b>11</b> The Cox Regression Model</a></li>
<li class="chapter" data-level="12" data-path="model-checking-in-the-cox-regression-model.html"><a href="model-checking-in-the-cox-regression-model.html"><i class="fa fa-check"></i><b>12</b> Model Checking in the Cox Regression Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="model-checking-in-the-cox-regression-model.html"><a href="model-checking-in-the-cox-regression-model.html#example-one"><i class="fa fa-check"></i><b>12.1</b> Example one</a></li>
<li class="chapter" data-level="12.2" data-path="model-checking-in-the-cox-regression-model.html"><a href="model-checking-in-the-cox-regression-model.html#example-two"><i class="fa fa-check"></i><b>12.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="parametric-proportional-hazards-models.html"><a href="parametric-proportional-hazards-models.html"><i class="fa fa-check"></i><b>13</b> Parametric Proportional Hazards Models</a></li>
<li class="chapter" data-level="14" data-path="time-dependent-variables-and-covariates.html"><a href="time-dependent-variables-and-covariates.html"><i class="fa fa-check"></i><b>14</b> Time-Dependent Variables and Covariates</a></li>
<li class="chapter" data-level="15" data-path="competing-risks.html"><a href="competing-risks.html"><i class="fa fa-check"></i><b>15</b> Competing Risks</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lecture Notes on Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="miðgildi-lifunar-og-logrank-próf" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Miðgildi lifunar og logrank próf</h1>
<p>Algeng leið til að lýsa lifun er svokallað <strong>miðgildi lifunar</strong> (median survival). Það er sú tímalengd <span class="math inline">\(T\)</span> þar sem <span class="math inline">\(S(T)\)</span> verður minna en 50%. Með orðum er það sá tímapunktur þegar helmingur þátttakandanna ættu að hafa fengið atburðinn. Með því að skrifa út nafnið á lifunarhlutnum okkar fæst mat á miðgildi lifunar ásamt 95% öryggisbili.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="miðgildi-lifunar-og-logrank-próf.html#cb22-1"></a>kmfit<span class="fl">.2</span></span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time169, chd69) ~ dibpat0f, data = wcgs)
## 
##               n events median 0.95LCL 0.95UCL
## dibpat0f=B 1565     79     NA      NA      NA
## dibpat0f=A 1589    178     NA      NA      NA</code></pre>
<p>Hér vandast málið! Við sjáum bara NA. Ástæða þess er sú að karlmönnunum i WCGS rannsókninni var ekki fylgt eftir svo lengi að helmingur þeirra hefði þróað með sér hjartasjúkdóm. Í slíkum tilvikum er ekki við hæfi að lýsa lifunarfallinu með miðgildi lifunar, heldur er oft miðað við eins árs, eða fimm ára lifun, svo dæmi séu tekin. Með eins árs lifun er átt við matinu á lifunarfallinu þegar ár er liðið. Þegar lifun er mæld í dögum eins og hjá okkur er það þá <span class="math inline">\(\hat S(365.25)\)</span>. Að sama skapi væri matið á fimm ára lifun <span class="math inline">\(\hat S(1826.25)\)</span>. (Ath 5*365.25=18625.)</p>
<p>Það er auðvelt að biðja R um mat á lifunarfallinu fyrir hvaða tímapunkt sem er. Það er gert með skipuninni <em>summary()</em> sem er mötuð með <em>times()</em> þar sem tímapunktarnir eru skilgreindir.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="miðgildi-lifunar-og-logrank-próf.html#cb24-1"></a><span class="kw">summary</span>(kmfit<span class="fl">.2</span>, <span class="dt">times=</span><span class="kw">c</span>(<span class="fl">365.25</span>,<span class="dv">5</span><span class="op">*</span><span class="fl">365.25</span>))</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time169, chd69) ~ dibpat0f, data = wcgs)
## 
##                 dibpat0f=B 
##  time n.risk n.event survival  std.err lower 95% CI upper 95% CI
##   365   1561       2    0.999 0.000904        0.997        1.000
##  1826   1433      36    0.975 0.004026        0.967        0.983
## 
##                 dibpat0f=A 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##   365   1574      13    0.992 0.00226        0.987        0.996
##  1826   1348      88    0.934 0.00635        0.922        0.947</code></pre>
<p>Við sjáum að matið á 365 daga (1 árs) lifun fyrir persónuleikagerð B er 0.99 með 95% ÖB (0.997-1.00) en matið á 365 daga lifun fyrir persónuleikagerð A er 0.992 með 95% ÖB (0.987-0.996). Í neðri línunum sjáum við matið á 1825 (5 ára) lifun. Það er 0.975 (0.967-0.983) fyrir persónuleikagerð B en 0.934 (0.922-0.947) fyrir persónuleikagerð A.</p>
<p>Allt að ofan bendir til þess að það sé munur í tíðni hjartasjúkdóma eftir persónuleikagerðum. Ein leið til að prófa þann mun er með <strong>logrank prófi</strong> en það prófar hvort munur sé á tveimur lifunarföllum. Skipunin er einfaldlega <em>survdiff</em> og rithátturinn er nákvæmlega sá sami og fyrir <em>surffit</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="miðgildi-lifunar-og-logrank-próf.html#cb26-1"></a><span class="kw">survdiff</span>(<span class="kw">Surv</span>(time169,chd69)<span class="op">~</span>dibpat0f,<span class="dt">data=</span>wcgs)</span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time169, chd69) ~ dibpat0f, data = wcgs)
## 
##               N Observed Expected (O-E)^2/E (O-E)^2/V
## dibpat0f=B 1565       79      131      20.5      41.8
## dibpat0f=A 1589      178      126      21.3      41.8
## 
##  Chisq= 41.8  on 1 degrees of freedom, p= 1e-10</code></pre>
<p>Og mikið rétt! Munurinn reyndist marktækur, p-gildið er <span class="math inline">\(1 \cdot 10^{-10}\)</span>. Logrank prófið er líka hægt að nota þegar hóparnir eru fleiri en tveir og prófa það þá núlltilgátuna hvort allir ferlarnir séu eins.</p>
<p>Núlltilgátan er að atburðir séu jafn tíðir milli hópanna. Taflan sýnir <em>Expected</em> eða væntanlegan fjölda miðað við þá tilgátu. En gögnin sýna (<em>Observed</em>) að atburðir eru færri í B hóp og fleiri í A hóp en búast mætti við ef tilgátan væri sönn. Við höfnum þeirri tilgátu og drögum þá ályktun að tíðni atburða sé meiri í A hóp.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="kaplan-meier-gröf-eftir-hópum.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="víti-að-varast-og-breyting-á-tímaskala.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Survival_Analysis.pdf", "Survival_Analysis.epub"],
"toc": {
"collapse": "subsection"
},
"code_folding": "hide"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
